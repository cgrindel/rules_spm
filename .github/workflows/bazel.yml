name: Build

on:
  pull_request:
    branches: [ main ]

jobs:
  build:

    runs-on: macos-11.0

    steps:
    - uses: actions/checkout@v2

    - name: Output the Bazel Info
      shell: bash
      run: |
        bazelisk info

    - name: Execute Tests
      shell: bash
      run: |
        bazelisk test //... 

    - name: Build Anything Not Tested
      shell: bash
      run: |
        bazelisk build //... 

    - name: Test Simple Example
      shell: bash
      run: |
        cd examples/simple
        bazelisk test //...

    - name: Build Simple_C Example
      shell: bash
      run: |
        cd examples/simple_c
        bazelisk test //...

    - name: Test Complex Example
      shell: bash
      run: |
        cd examples/complex
        bazelisk test //...

    - name: Test Package With Deps Example
      shell: bash
      run: |
        cd examples/package_with_deps
        bazelisk test //...

    - name: Test Vapor Example
      shell: bash
      run: |
        cd examples/vapor
        bazelisk test //...

    - name: Test iOS Simulator Example
      shell: bash
      run: |
        cd examples/ios_sim
        bazelisk test //...
